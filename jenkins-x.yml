buildPack: none

pipelineConfig:
  pipelines:
    pullRequest:
      build:
        steps:
        - sh: cmake -G Ninja -DCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=TRUE
          name: cmake
        - sh: cmake --build -- -d explain -v
          name: cmake--build
    release:
      setVersion:
        steps:
        - sh: echo \$(jx-release-version) > VERSION
          name: next-version
          comment: so we can retrieve the version in later steps
        - sh: jx step tag --version \$(cat VERSION)
          name: tag-version
      build:
        steps:
        - sh: cmake -G Ninja -DCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=TRUE
          name: cmake
        - sh: cmake --build -- -d explain -v
          name: cmake--build
